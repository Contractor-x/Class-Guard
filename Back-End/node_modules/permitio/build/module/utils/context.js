/**
 * Store for contexted passed as part of check() queries
 */
export class ContextStore {
    constructor() {
        this.baseContext = {}; // cross-query context (global context)
        this.transforms = [];
    }
    /**
     * add context to the base context
     */
    add(context) {
        this.baseContext = Object.assign(this.baseContext, context);
    }
    registerTransform(transform) {
        this.transforms.push(transform);
    }
    /**
     * merges the global context (this.context) with the context
     * provided for this specific query (context). the specific
     * context overrides the base (global) context.
     */
    getDerivedContext(context) {
        return Object.assign({}, this.baseContext, context);
    }
    transform(initialContext) {
        let context = { ...initialContext };
        for (const transform of this.transforms) {
            context = transform(context);
        }
        return context;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGV4dC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy91dGlscy9jb250ZXh0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWFBOztHQUVHO0FBQ0gsTUFBTSxPQUFPLFlBQVk7SUFBekI7UUFDVSxnQkFBVyxHQUFZLEVBQUUsQ0FBQyxDQUFDLHVDQUF1QztRQUNsRSxlQUFVLEdBQXVCLEVBQUUsQ0FBQztJQTZCOUMsQ0FBQztJQTNCQzs7T0FFRztJQUNJLEdBQUcsQ0FBQyxPQUFnQjtRQUN6QixJQUFJLENBQUMsV0FBVyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUM5RCxDQUFDO0lBRU0saUJBQWlCLENBQUMsU0FBMkI7UUFDbEQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDbEMsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxpQkFBaUIsQ0FBQyxPQUFnQjtRQUN2QyxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQyxXQUFXLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDdEQsQ0FBQztJQUVNLFNBQVMsQ0FBQyxjQUF1QjtRQUN0QyxJQUFJLE9BQU8sR0FBRyxFQUFFLEdBQUcsY0FBYyxFQUFFLENBQUM7UUFDcEMsS0FBSyxNQUFNLFNBQVMsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFO1lBQ3ZDLE9BQU8sR0FBRyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDOUI7UUFDRCxPQUFPLE9BQU8sQ0FBQztJQUNqQixDQUFDO0NBQ0YifQ==